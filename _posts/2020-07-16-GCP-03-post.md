---
title: Google Cloud Platform - Cloud Composer
date : 2020-07-16 10:48:30 -0400
categories : GCP Google Cloud
---

#### 1. Cloud Composer 정의 : 파이프라인을 작성하여 예약 및 모니터링 할 수 있는 통합 위크플로 관리 서비스이다.



#### 2. Cloud Composer 특징 
* 내부적으로 아파치 에어플로를 기반으로한 워크플로 통합서비스로 Google Cloud Platform의 다양한 서비스들이 활용되어 있다.
* 구글 쿠버네티스 엔진을 기반으로한 배포환경을 가지고 있으며, Cloud SQL을 이용하여 메타 데이터를 저장하고, 앱엔진을 활용하여 에어플로 웹서버를 호스팅하며 로그관리는 Stack Driver를 이용한다.
* Python을 기반으로 DAG와 태스크(Task)에 대한 코드를 작성할 수 있으며 분산환경 및 웹 UI 기반의 강력한 모니터링 기능을 제공해 간편하게 모니터링 할 수 있다.



#### 3. Apache Airflow 
* 설명 : 유명한 여행서비스 회사인 에어비엔티에서 개발된 워크플로 통합도구로 현재는 아파재단에서 인큐베이팅하고 있는 프로젝트이다.
* 장점 : 데이터분석가 및 개발자 모두가 익숙한 언어인 Python을 기본으로 태스크에 대한 코드를 작성할 수 있어서 접근성이 낮은 면있다, 웹 UI기반의 강력한 모니터링 툴을 제공하기 때문에 웹브라우저를 통해서 손쉽게 모니터링 할 수 있다.



#### 4. Cloud Composer 주요개념
* DAG : 비순환 그래프로 표현된다, 다시말해 하나의 DAG가 하나의 워크플로라고 생각하면 된다.
* Operator 와 Task : 오퍼레이터는 DAG안에 정의되는 작업함수이며, 이를 이용해 태스크를 만든다.
    - Bash Operator : 배시내의 쉘명령어를 태스크로 사용할 수 있게 도와주는 오퍼레이터
    - Python Operator : Python으로 만든 함수를 태스크로 사용할 수 있게 도와주는 오퍼레이터
* 데이터 저장 : 생성시 자동으로 Google Cloud Storage 내에 버킷을 만들고, 클라우드 스토리지 FUSE를 사용하여 에어플로 인스턴스와 GCS버킷을 서로 매핑한다, 이때 버킷의 이름은 환경영역, 이름 및 랜덤한 ID를 기반으로 생성되고 버킷에 저장된 데이터를 통해 컴포저(composer)를 관리 한다.
